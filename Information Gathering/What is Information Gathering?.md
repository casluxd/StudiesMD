A fase de [coleta de informações](https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/01-Information_Gathering/README) é o primeiro passo em todos os testes de penetração em que precisamos simular invasores externos sem informações internas da organização de destino. Essa fase é crucial, pois a coleta de informações precária e precária pode resultar em falhas que, de outra forma, uma enumeração completa teria descoberto.

![[Pasted image 20230629193315.png]]

Essa fase nos ajuda a entender a superfície de ataque, as tecnologias usadas e, em alguns casos, descubra ambientes de desenvolvimento ou mesmo infraestrutura esquecida e não mantida que pode nos levar ao acesso interno à rede, pois geralmente são menos protegidos e monitorados. A coleta de informações é tipicamente um processo iterativo. À medida que descobrimos ativos (, por exemplo, um subdomínio ou host virtual ), precisaremos imprimir as tecnologias em uso, procurar páginas / diretórios ocultos etc., o que pode nos levar a descobrir outro subdomínio e iniciar o processo novamente.

Por exemplo, podemos pensar nisso como tropeçando em novos subdomínios durante um de nossos testes de penetração com base no certificado SSL. No entanto, se examinarmos mais de perto esses subdomínios, frequentemente veremos diferentes tecnologias em uso do que o site principal da empresa. Subdomínios e vhosts são usados para apresentar outras informações e executar outras tarefas que foram separadas da página inicial. Portanto, é essencial descobrir quais tecnologias são usadas, qual a finalidade que elas servem e como elas funcionam. Durante esse processo, nosso objetivo é identificar o máximo de informações possível nas seguintes áreas:

|Área|Descrição|
|---|---|
|Domínios e subdomínios|Muitas vezes, recebemos um único domínio ou talvez uma lista de domínios e subdomínios que pertencem a uma organização. Muitas organizações não possuem um inventário preciso de ativos e podem ter esquecido domínios e subdomínios expostos externamente. Esta é uma parte essencial da fase de reconhecimento. Podemos encontrar vários subdomínios que mapeiam os endereços IP no escopo, aumentando a superfície geral de ataque do nosso programa de envolvimento ( ou de recompensas por bugs ). Subdomínios ocultos e esquecidos podem ter versões antigas / vulneráveis de aplicativos ou versões dev com funcionalidade adicional ( um console de depuração Python, por exemplo ). Os programas de recompensas de bugs geralmente definem o escopo como algo como `*.inlanefreight.com`, significando que todos os subdomínios de `inlanefreight.com`, neste exemplo, estão no escopo ( ou seja., `acme.inlanefreight.com`, `admin.inlanefreight.com`, e assim por diante e assim por diante ). Também podemos descobrir subdomínios de subdomínios. Por exemplo, vamos supor que descobrimos algo como `admin.inlanefreight.com`. Poderíamos então executar mais enumerações de subdomínio contra esse subdomínio e talvez encontrar `dev.admin.inlanefreight.com` como um alvo muito atraente. Existem muitas maneiras de encontrar subdomínios ( passivamente e ativamente ) que abordaremos mais adiante neste módulo.|
|Intervalos de IP|A menos que estejamos limitados a um escopo muito específico, queremos descobrir o máximo possível sobre nosso objetivo. Encontrar intervalos de IP adicionais pertencentes ao nosso alvo pode levar à descoberta de outros domínios e subdomínios e abrir nossa possível superfície de ataque ainda mais ampla.|
|Infraestrutura|Queremos aprender o máximo possível sobre nosso objetivo. Precisamos saber qual tecnologia empilha nosso alvo. Suas aplicações são todas ASP.NET? Eles usam Django, PHP, Flask, etc.? Que tipo ( s ) de APIs / serviços da web estão em uso? Eles estão usando sistemas de gerenciamento de conteúdo ( CMS ), como WordPress, Joomla, Drupal ou DotNetNuke, que têm seus próprios tipos de vulnerabilidades e configurações incorretas que podemos encontrar? Também nos preocupamos com os servidores da Web em uso, como IIS, Nginx, Apache e os números da versão. Se nosso destino estiver executando estruturas ou servidores da Web desatualizados, queremos aprofundar os aplicativos da Web associados. Também estamos interessados nos tipos de bancos de dados de back-end em uso ( MSSQL, MySQL, PostgreSQL, SQLite, Oracle, etc.), pois isso nos dará uma indicação dos tipos de ataques que podemos realizar.|
|Hosts virtuais|Por fim, queremos enumerar hosts virtuais ( vhosts ), que são semelhantes aos subdomínios, mas indicam que uma organização está hospedando vários aplicativos no mesmo servidor da web. Abordaremos a enumeração vhost mais tarde no módulo também.|

Podemos dividir o processo de coleta de informações em duas categorias principais:

|Categoria|Descrição|
|---|---|
|Coleta passiva de informações|Não interagimos diretamente com o alvo nesta fase. Em vez disso, coletamos informações publicamente disponíveis usando mecanismos de pesquisa, whois, informações de certificado etc. O objetivo é obter o máximo de informações possível para usar como entradas para a fase de coleta de informações ativas.|
|Coleta ativa de informações|Interagimos diretamente com o alvo nesta fase. Antes de realizar a coleta ativa de informações, precisamos garantir que temos a autorização necessária para testar. Caso contrário, provavelmente estaremos envolvidos em atividades ilegais. Algumas das técnicas usadas no estágio de coleta de informações ativas incluem digitalização de portas, enumeração de DNS, aplicação de bruto de diretórios, enumeração de host virtual e rastreamento / spidering de aplicativos da web.|

É crucial manter as informações que coletamos bem organizadas, pois precisaremos de vários dados como entradas para posterior fase do processo de teste. Dependendo do tipo de avaliação que estamos realizando, talvez seja necessário incluir alguns desses dados de enumeração em nosso relatório final, que pode ser entregue (, como um Teste de Penetração Externa ). Ao escrever um relatório de recompra de bugs, precisaremos incluir apenas detalhes relevantes especificamente para o bug que estamos relatando ( ou seja., um subdomínio oculto que descobrimos levou à divulgação de outro subdomínio que aproveitamos para obter a execução remota de código ( RCE ) contra nosso alvo ).

Vale a pena se inscrever em uma conta em [Hackerone](https://hackerone.com/bug-bounty-programs), lendo a lista de programas e escolhendo alguns destinos para reproduzir todos os exemplos neste módulo. A prática leva à perfeição. A prática contínua dessas técnicas nos ajudará a aprimorar nosso ofício e tornar muitas dessas etapas de coleta de informações uma segunda natureza. À medida que nos sentimos mais confortáveis com as ferramentas e técnicas mostradas neste módulo, devemos desenvolver nossa própria metodologia repetível. Podemos achar que gostamos de ferramentas específicas e técnicas de linha de comando para algumas fases da coleta de informações e descobrimos diferentes ferramentas que preferimos para outras fases. Podemos escrever nossos próprios scripts para automatizar algumas dessas fases também.

## Seguindo em frente

Vamos seguir em frente e discutir a coleta passiva de informações. Para os exemplos e exercícios da seção do módulo, focaremos no Facebook, que possui [programa de recompensas de bugs](https://www.facebook.com/whitehat), [PayPal](https://hackerone.com/paypal?type=team), [Tesla](https://bugcrowd.com/tesla), e hosts de laboratório internos. Ao executar os exemplos de coleta de informações, devemos ter certeza de não nos afastar do escopo do programa, que lista sites e aplicativos dentro e fora do escopo e ataques fora do escopo, como ataques de segurança física, engenharia social, uso de scanners de vulnerabilidade automatizados, ataque man-in-the-middle, etc.

