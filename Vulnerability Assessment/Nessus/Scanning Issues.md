O Nessus é uma plataforma de verificação de vulnerabilidades bem conhecida e amplamente usada. No entanto, algumas práticas recomendadas devem ser levadas em consideração antes de iniciar uma verificação. As verificações podem causar problemas em redes confidenciais e fornecer falsos positivos, sem resultados ou ter um impacto desfavorável na rede. É sempre melhor se comunicar com seu cliente ( ou partes interessadas internas se estiver executando uma verificação em relação à sua própria rede ) sobre se há algum sensível/hosts legados devem ser excluídos da verificação ou se algum host de alta prioridade / alta disponibilidade deve ser verificado separadamente, fora do horário comercial ou com configurações diferentes de verificação para evitar possíveis problemas.

Também há momentos em que uma verificação pode retornar resultados inesperados e precisar ser ajustada.

## Mitigando problemas

Alguns firewalls nos farão receber resultados de verificação mostrando todas as portas abertas ou nenhuma porta aberta. Se isso acontecer, uma correção rápida geralmente é configurar uma verificação avançada e desativar a opção `Ping the remote host`. Isso impedirá que a verificação use o ICMP para verificar se o host está "ao vivo" e, em vez disso, prosseguirá com a verificação. Alguns firewalls podem retornar uma mensagem "Incrível ao ICMP" que Nessus interpretará como um host ao vivo e fornecerá muitas descobertas informativas falsas positivas.

Em redes sensíveis, podemos usar o limite de taxa para minimizar o impacto. Por exemplo, podemos ajustar `Performance Options` e modificar `Max Concurrent Checks Per Host` se o host de destino estiver frequentemente sob carga pesada, como um aplicativo da Web amplamente usado. Isso limitará o número de plugins usados simultaneamente contra o host.

Podemos evitar o scanning de sistemas legados e escolher a opção de não scannear impressoras, como mostramos em uma seção anterior. Se um host é particularmente preocupante, ele deve ser deixado de fora do escopo de destino, pois o Nessus não tem uma opção para uma "lista de exclusão" de hosts dentro de um intervalo CIDR, como podemos fazer com ferramentas como o Nmap.

Finalmente, a menos que solicitado especificamente, nunca devemos executar [Verificações de negação de serviço](https://www.tenable.com/plugins/nessus/families/Denial%20of%20Service). Podemos garantir que esses tipos de plug-ins não sejam usados, sempre ativando a opção ["cheques seguros"](https://www.tenable.com/blog/understanding-the-nessus-safe-checks-option) ao executar verificações para evitar plugins de rede que possam ter um impacto negativo em um destino, como travar um daemon de rede. A ativação da opção "verificações seguras" não garante que uma verificação de vulnerabilidade do Nessus tenha zero impacto adverso, mas minimizará significativamente o impacto potencial e diminuirá o tempo de scanning.

É sempre melhor se comunicar com nossos clientes ou partes interessadas internas e alertar o pessoal necessário antes de iniciar uma verificação. Quando a verificação estiver concluída, devemos manter registros detalhados da atividade de digitalização, caso ocorra um incidente que deva ser investigado.

## Impacto na rede

Também é essencial ter em mente o impacto potencial da verificação de vulnerabilidades em uma rede, especialmente em links com baixa largura de banda ou congestionados. Isso pode ser medido usando [vnstat](https://humdi.net/vnstat/):

```shell-session
casluxd@htb[/htb]$ sudo apt install vnstat
```

Vamos monitorar o adaptador de rede `eth0` antes de executar uma verificação Nessus:

```shell-session
casluxd@htb[/htb]$ sudo vnstat -l -i eth0

Monitoring eth0...    (press CTRL-C to stop)

   rx:       332 bit/s     0 p/s          tx:       332 bit/s     0 p/s

   rx:         0 bit/s     0 p/s          tx:         0 bit/s     0 p/s
   rx:         0 bit/s     0 p/s          tx:         0 bit/s     0 p/s^C

 eth0  /  traffic statistics

                           rx         |       tx
--------------------------------------+------------------
  bytes                        572 B  |           392 B
--------------------------------------+------------------
          max              480 bit/s  |       332 bit/s
      average              114 bit/s  |        78 bit/s
          min                0 bit/s  |         0 bit/s
--------------------------------------+------------------
  packets                          8  |               5
--------------------------------------+------------------
          max                  1 p/s  |           0 p/s
      average                  0 p/s  |           0 p/s
          min                  0 p/s  |           0 p/s
--------------------------------------+------------------
  time                    40 seconds
```

Podemos comparar esse resultado com o resultado obtido ao monitorar a mesma interface durante uma verificação do Nessus em apenas um host:

```shell-session
casluxd@htb[/htb]$ sudo vnstat -l -i eth0

Monitoring eth0...    (press CTRL-C to stop)

   rx:   307.92 kbit/s   641 p/s          tx:   380.41 kbit/s   767 p/s^C

 eth0  /  traffic statistics

                           rx         |       tx
--------------------------------------+------------------
  bytes                     1.04 MiB  |        1.34 MiB
--------------------------------------+------------------
          max          414.81 kbit/s  |   480.59 kbit/s
      average          230.57 kbit/s  |   296.72 kbit/s
          min                0 bit/s  |         0 bit/s
--------------------------------------+------------------
  packets                      18252  |           22733
--------------------------------------+------------------
          max                864 p/s  |         969 p/s
      average                480 p/s  |         598 p/s
          min                  0 p/s  |           0 p/s
--------------------------------------+------------------
  time                    38 seconds


real  0m38.588s
user  0m0.002s
sys 0m0.016s
```

Ao comparar os resultados, podemos ver que o número de bytes e pacotes transferidos durante uma verificação de vulnerabilidade é bastante significativo e pode afetar gravemente uma rede se não estiver ajustada corretamente ou executada em dispositivos frágeis / sensíveis.