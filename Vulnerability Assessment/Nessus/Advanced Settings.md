Podemos configurar várias configurações avançadas para o Nessus e suas digitalizações, como políticas de digitalização, plugins e credenciais, todas as quais abordaremos nesta seção.

## Políticas de verificação

O Nessus nos oferece a opção de criar políticas de verificação. Essencialmente, essas são verificações personalizadas que nos permitem definir opções específicas de verificação, salvar a configuração da política e disponibilizá-las em `Scan Templates` ao criar uma nova verificação. Isso nos permite criar verificações direcionadas para qualquer número de cenários, como uma verificação mais lenta e evasiva, uma verificação focada na Web, ou uma verificação para um cliente específico usando um ou vários conjuntos de credenciais. As políticas de verificação podem ser importadas de outros scanners Nessus ou exportadas para serem posteriormente importadas para outro scanner Nessus.

![[Pasted image 20230702220319.png]]

## Criando uma política de verificação

Para criar uma política de verificação, podemos clicar no `New Policy` botão no canto superior direito e seremos apresentados à lista de verificações pré-configuradas. Podemos escolher uma digitalização, como a `Basic Network Scan`, personalize-o ou podemos criar o nosso. Nós vamos escolher `Advanced Scan` para criar uma verificação totalmente personalizada, sem recomendações pré-configuradas incorporadas.

Depois de escolher o tipo de verificação como nossa base, podemos atribuir à política de verificação um nome e uma descrição, se necessário: 

![imagem](https://academy.hackthebox.com/storage/modules/108/nessus/policy.png)

A partir daqui, podemos configurar configurações, adicionar credenciais necessárias e especificar quaisquer padrões de conformidade para executar a verificação. Também podemos optar por ativar ou desativar todo [plug-in](https://docs.tenable.com/nessus/Content/Plugins.htm) famílias ou plugins individuais.

Depois de concluir a personalização da verificação, podemos clicar em `Save`, e a política recém-criada aparecerá na lista de políticas. A partir daqui, quando criarmos uma nova verificação, haverá uma nova guia chamada `User Defined` sob `Scan Templates` que mostrará todas as nossas políticas de verificação personalizadas: 

![imagem](https://academy.hackthebox.com/storage/modules/108/nessus/htb_policydefined.png)

## Nessus Plugins

Nessus trabalha com plugins escritos no [Nessus Attack Scripting Language ( NASL )](https://en.wikipedia.org/wiki/Nessus_Attack_Scripting_Language) e pode segmentar novas vulnerabilidades e CVEs. Esses plugins contêm informações como o nome da vulnerabilidade, impacto, correção e uma maneira de testar a presença de um problema específico.

Os plugins são classificados por nível de gravidade: `Critical`, `High`, `Medium`, `Low`, `Info`. No momento da redação deste artigo, Tenable publicou `145,973` plugins que cobrem `58,391` IDs e `30,696` [Bugtraq](https://en.wikipedia.org/wiki/Bugtraq) IDs. Um banco de dados pesquisável de todos os plugins publicados está no [Site sustentável](https://www.tenable.com/plugins).
 
A guia `Plugins` fornece mais informações sobre uma detecção específica, incluindo mitigação. Ao realizar verificações recorrentes, pode haver uma vulnerabilidade / detecção que, após um exame mais aprofundado, não é considerada um problema. Por exemplo, o Microsoft DirectAccess (, uma tecnologia que fornece conectividade de rede interna aos clientes pela Internet ) permite suítes de cifras inseguras e nulas. A verificação abaixo foi realizada com `sslscan` mostra um exemplo de suítes cifradas inseguras e nulas:

```shell-session
casluxd@htb[/htb]$ sslscan example.com

<SNIP>

Preferred TLSv1.0  128 bits  ECDHE-RSA-AES128-SHA          Curve 25519 DHE 253
Accepted  TLSv1.0  256 bits  ECDHE-RSA-AES256-SHA          Curve 25519 DHE 253
Accepted  TLSv1.0  128 bits  DHE-RSA-AES128-SHA            DHE 2048 bits
Accepted  TLSv1.0  256 bits  DHE-RSA-AES256-SHA            DHE 2048 bits
Accepted  TLSv1.0  128 bits  AES128-SHA                   
Accepted  TLSv1.0  256 bits  AES256-SHA                   

<SNIP>
```

No entanto, isso é por design. SSL / TLS não é [requerido](https://directaccess.richardhicks.com/2014/09/23/directaccess-ip-https-ssl-and-tls-insecure-cipher-suites/) nesse caso, e implementá-lo resultaria em um impacto negativo no desempenho. Para excluir esse falso positivo dos resultados da verificação, mantendo a detecção ativa para outros hosts, podemos criar uma regra de plug-in: 

![imagem](https://academy.hackthebox.com/storage/modules/108/nessus/plugin_rules.png)

Sob a seção `Resources`, podemos selecionar `Plugin Rules`. Na nova regra de plug-in, inserimos o host a ser excluído, juntamente com o ID do plug-in do Microsoft DirectAccess, e especificamos a ação a ser executada como `Hide this result`: ![imagem](https://academy.hackthebox.com/storage/modules/108/nessus/new-rule.png)

Também podemos excluir determinados problemas dos resultados de nossa verificação, como plug-ins para problemas que não são diretamente exploráveis ( por exemplo., [Certificado autoassinado SSL](https://www.tenable.com/plugins/nessus/57582)). Podemos fazer isso especificando o ID do plug-in e o host ( s ) a serem excluídos: 

![imagem](https://academy.hackthebox.com/storage/modules/108/nessus/plugins2.png)

## Scanning com credenciais

O Nessus também suporta scanning credenciada e oferece muita flexibilidade, suportando hashes LM / NTLM, autenticação Kerberos e autenticação por senha.

As credenciais podem ser configuradas para autenticação baseada em host via SSH com uma senha, chave pública, certificado ou autenticação baseada em Kerberos. Também pode ser configurado para autenticação baseada em host do Windows com uma senha, hash Kerberos, LM ou hash NTLM:

![imagem](https://academy.hackthebox.com/storage/modules/108/nessus/creds.png)

O Nessus também suporta autenticação para uma variedade de tipos de bancos de dados, incluindo Oracle, PostgreSQL, DB2, MySQL, SQL Server, MongoDB e Sybase: 

![imagem](https://academy.hackthebox.com/storage/modules/108/nessus/db_creds.png)

**Nota:** Para executar uma verificação credencial no destino, use as seguintes credenciais: `htb-student_adm`:`HTB_@cademy_student!` para Linux e `administrator`:`Academy_VA_adm1!` para Windows. Essas verificações já foram configuradas no destino Nessus para economizar tempo.

Além disso, o Nessus pode executar autenticação de texto sem formatação em serviços como FTP, HTTP, IMAP, IPMI, Telnet e muito mais:

![imagem](https://academy.hackthebox.com/storage/modules/108/nessus/plaintext_auth.png)

Por fim, podemos verificar a saída do Nessus para confirmar se a autenticação no aplicativo ou serviço de destino com as credenciais fornecidas foi bem-sucedida: 

![imagem](https://academy.hackthebox.com/storage/modules/108/nessus/sqlserv.png)
