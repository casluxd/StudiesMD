
## Linguagem de avaliação de vulnerabilidade aberta (OVAL)

[Linguagem de avaliação de vulnerabilidade aberta ( OVAL )](https://oval.mitre.org/) é um padrão internacional de segurança da informação disponível ao público usado para avaliar e detalhar o estado e os problemas atuais do sistema. A OVAL também é co-apoiada pelo escritório de segurança cibernética e comunicações dos EUA (Departamento de Segurança Interna). OVAL fornece um idioma para entender os atributos do sistema de codificação e vários repositórios de conteúdo compartilhados na comunidade de segurança. O repositório OVAL possui mais de 7000 definições + para uso público. Além disso, o OVAL também é usado pelos EUA. Protocolo de automação de conteúdo de segurança ( NIST ) do Instituto Nacional de Padrões e Tecnologia ( SCAP ), que reúne idéias da comunidade para automatizar o gerenciamento de vulnerabilidades, medir e garantir que os sistemas atendam à conformidade com as políticas.

#### Processo OVAL

![[Pasted image 20230702214139.png]]

O objetivo do idioma OVAL é ter uma estrutura de três etapas durante o processo de avaliação que consiste em:

- Identificando as configurações de um sistema para testar
- Avaliando o estado do sistema atual
- Divulgando as informações em um relatório

As informações podem ser descritas em vários tipos de estados, incluindo: `Vulnerable`, `Non-compliant`, `Installed Asset`, e `Patched`.

#### Definições OVAL

As definições OVAL são registradas em um formato XML para descobrir quaisquer vulnerabilidades de software, configurações incorretas, programas e informações adicionais do sistema, eliminando a necessidade de explorar um sistema. Por ter a capacidade de identificar problemas sem explorar diretamente o problema, uma organização pode correlacionar quais sistemas precisam ser corrigidos em uma rede.

As quatro principais classes de definições OVAL consistem em:
- `OVAL Vulnerability Definitions`: Identifica vulnerabilidades do sistema
- `OVAL Compliance Definitions`: Identifica se as configurações atuais do sistema atendem aos requisitos da política do sistema
-  `OVAL Inventory Definitions`: Avalia um sistema para verificar se um software específico está presente
- `OVAL Patch Definitions`: Identifica se um sistema possui o patch apropriado

Além disso, o `OVAL ID Format` consiste em um formato exclusivo que consiste em "oval: Nome do Domínio da Organização: Tipo de ID: Valor de ID". O `ID Type` pode cair em várias categorias, incluindo: definição (`def`), objeto (`obj`), estado (`ste`) e variável (`var`). Um exemplo de um identificador exclusivo seria `oval:org.mitre.oval:obj:1116`.

Scanners como o Nessus têm a capacidade de usar o OVAL para configurar modelos de verificação de conformidade de segurança.

## Vulnerabilidades e exposições comuns ( CVE )

[Vulnerabilidades e exposições comuns ( CVE )](https://cve.mitre.org/) é um catálogo disponível ao público de questões de segurança patrocinado pelo Departamento de Segurança Interna dos Estados Unidos ( DHS ). Cada problema de segurança possui um número de ID CVE exclusivo atribuído pela Autoridade de Numeração do CVE ( CNA ). O objetivo de criar um número de ID CVE exclusivo é criar uma padronização para uma vulnerabilidade ou exposição, conforme um pesquisador a identifica. Um CVE consiste em informações críticas sobre uma vulnerabilidade ou exposição, incluindo uma descrição e referências sobre o problema. As informações em um CVE permitem que a equipe de TI de uma organização entenda o quão prejudicial um problema pode ser para o ambiente.

O gráfico a seguir explica como um ID CVE pode ser atribuído a uma vulnerabilidade. Quaisquer vulnerabilidades atribuídas a um CVE devem ser corrigíveis independentemente, afetar apenas uma base de código e ser reconhecidas e documentadas pelo fornecedor relevante.

![[Pasted image 20230702214310.png]]

## Etapas de obtenção de um CVE

#### Etapa 1: identifique se o CVE é obrigatório e relevante

Identifique se o problema encontrado é uma vulnerabilidade. De acordo com a equipe do CVE, "uma vulnerabilidade no contexto do programa CVE é indicada por código que pode ser explorado, resultando em um impacto negativo na confidencialidade, integridade ou disponibilidade, e isso requer uma alteração de codificação, alteração de especificação ou depreciação de especificação para mitigar ou endereçar." Além disso, a pesquisa deve verificar se ainda não existe um ID CVE no banco de dados CVE.

#### Etapa 2: alcançar o fornecedor de produtos afetados

Um pesquisador deve garantir que fez um esforço de boa fé para entrar em contato diretamente com um fornecedor. Pesquisadores podem fazer referência a CVEs [Documentos sobre práticas de divulgação](https://cve.mitre.org/cve/researcher_reservation_guidelines#appendix#a) para informações adicionais.

#### Etapa 3: identifique se a solicitação deve ser para o fornecedor CNA ou CNA de terceiros

Se uma empresa faz parte da CNA participante, ela pode atribuir um ID CVE para um de seus produtos. Se o problema for para um CNA participante, os pesquisadores podem entrar em contato com a organização apropriada do CNA [aqui](https://cve.mitre.org/cve/request_id.html). Se o fornecedor não for um CNA participante, um pesquisador deve tentar entrar em contato com o coordenador de terceiros do fornecedor.

#### Etapa 4: solicitando o ID do CVE através do formulário da Web do CVE

A equipe do CVE possui um formulário que pode ser preenchido online [aqui](https://cveform.mitre.org/) se os métodos acima não funcionarem para solicitações de CVE.

#### Etapa 5: Confirmação do formulário CVE

Ao enviar o formulário da Web do CVE mencionado no estágio 4, um indivíduo receberá um email de confirmação. A equipe do CVE entrará em contato com o solicitante se forem necessárias informações adicionais.

#### Etapa 6: recebimento do ID do CVE

Após a aprovação, a equipe do CVE notificará o solicitante de um ID do CVE se a vulnerabilidade do produto afetado for confirmada. Observe que o ID do CVE ainda não é público nesta fase.

#### Etapa 7: Divulgação pública do CVE ID

Os IDs do CVE podem ser anunciados ao público assim que fornecedores e partes apropriados estiverem cientes do problema para evitar a duplicação de IDs do CVE. Esse estágio garante que todas as partes associadas estejam cientes do problema antes de serem divulgadas publicamente.

#### Etapa 8: Anunciando o CVE

A equipe do CVE pede aos pesquisadores que estão compartilhando vários CVEs para garantir que cada CVE indique as diferentes vulnerabilidades. Informações adicionais podem ser encontradas [aqui](https://cve.mitre.org/cve/researcher_reservation_guidelines).

#### Etapa 9: Fornecendo informações para a equipe do CVE

Nesta fase, a equipe do CVE pede que o pesquisador ajude a fornecer informações adicionais a serem usadas na lista oficial do CVE no site. O [EUA. Banco de Dados Nacional de Vulnerabilidade ( NVD )](https://nvd.nist.gov/) mantém essas informações on-line também em seu banco de dados.

## Divulgação Responsável

Pesquisadores e consultores de segurança fazem referência constantemente ao banco de dados do CVE, pois consiste em milhares de vulnerabilidades que podem ser aproveitadas para exploração. Além disso, também há momentos em que os indivíduos podem se deparar com um problema que nunca viram na natureza ou que nunca foi divulgado enquanto pesquisavam um software ou programa específico.

A divulgação responsável é essencial na comunidade de segurança, pois permite que uma organização ou pesquisador trabalhe diretamente com um fornecedor, fornecendo os detalhes do problema primeiro para garantir que um patch esteja disponível antes o anúncio da vulnerabilidade ao mundo. Se um problema não for divulgado com responsabilidade a um fornecedor, os atores reais da ameaça poderão alavancar os problemas para uso criminoso, também chamados de `zero day` ou um `0-day`.

## Exemplos

#### CVE-2020-5902

[CVE-2020-5902](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-5902) é uma vulnerabilidade de execução remota de código não autenticada na interface do usuário do gerenciamento de tráfego BIG-IP ( TMUI ). O problema é explorável quando o TMUI está disponível na porta de gerenciamento BIG-IP e leva a uma aquisição completa do sistema, pois um invasor pode executar código, editar arquivos, e ative ou desative os serviços no host remoto.

#### CVE-2021-34527

[CVE-2021-34527](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34527), também conhecido como PrintNightmare, é uma vulnerabilidade de execução remota de código no serviço Windows Print Spooler. O serviço Windows Print Spooler pode ser abusado devido ao serviço que manipula indevidamente as operações de arquivos de privilégios. O problema exige que um usuário seja autenticado, mas permite a aquisição completa de um sistema da execução remota ou local do código. O problema é extremamente perigoso, pois permite que um invasor controle totalmente um domínio, pois explora servidores (incluindo controladores de domínio) e estações de trabalho.

